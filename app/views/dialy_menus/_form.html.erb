<%= error_messages_for :record %>
<% row_id = "record_#{@record.id ? @record.id : 'new'}" %>
<% remote_form_for :record, :url => url, :html => {:class => "dialy_menu"} do |f| %>
  <p><label for="<%=row_id%>_date"><%= locales[:attr_date] %></label><br />
  <%= f.text_field :date, :id=> "#{row_id}_date", :class => 'datepicker' %></p>
  <% unless @record.new_record? %>
    <fieldset>
      <legend>Plánovaná jídla</legend>
      <table id="#<%= row_id %>_scheduled" class="admin">
        <thead>
          <tr>
            <td>zobrazit</td>
            <td>název</td>
            <td>cena</td>
            <td>kategorie</td>
          </tr>
        <tbody>
        <%- @record.meals.each do |meal| -%>
          <tr>
            <td>
                <%= check_box_tag("scheduled[#{meal.item_id}]", 1, !@record.banned?(meal.item_id))%>
                <%= hidden_field_tag "scheduled[#{meal.item_id}]", 0 %></td>
            <td><%= h meal.name %></td>
            <td><%= format_currency meal.price%></td>
            <td><%= h meal.category.name %></td>
          </tr>
        <%- end -%>
        </tbody>
      </table>
    </fieldset>
    <fieldset>
      <legend>Ostatní jídla</legend>
      <table id="<%= row_id %>_entries" class="admin">
        <thead>
          <tr>
            <td>název</td>
            <td>cena</td>
            <td>kategorie</td>
            <td><a href="#" class="add entry">přidat</a></td>
          </tr>
        </thead>
        <tbody>
          <tr class="sample">
            <td><%= text_field_tag "entries[ID][name]", nil, :class => "name", :size => 40 %></td>
            <td><%= text_field_tag "entries[ID][price]", nil, :class => "name", :size => 5 %>&nbsp;Kč</td>
            <td>
              <select class="category" name="entries[ID][category_id]">
                <option/>
                <%= options_from_collection_for_select @categories, :id, :name %>
              </select>
            </td>
            <td><a href="#" class="destroy">smazat</a><%= hidden_field_tag "entries[ID][_destroy]" %></td>
          </tr>
        <%- @record.entries.each do |entry| -%>
          <tr>
            <td><%= text_field_tag "entries[#{entry.id}][name]", entry.name, :class => "name", :size => 40 %></td>
            <td><%= text_field_tag "entries[#{entry.id}][price]", entry.price, :class => "name", :size => 5 %>&nbsp;Kč</td>
            <td>
              <select class="category" name="entries[<%=entry.id%>][category_id]">
                <option/>
                <%= options_from_collection_for_select @categories, :id, :name, entry.category_id %>
              </select>
            </td>
            <td><a href="#" class="destroy">smazat</a><%= hidden_field_tag "entries[#{entry.id}][_destroy]" %>
            </td>
          </tr>
        <%- end -%>
        </tbody>
      </table>
    </fieldset>
  <%end%>
<p><%= yield(:submit_button) || '<input type="submit" value="' + locales[:submit] + '" />' %></p>
<% end %>
<script type="text/javascript">
$(function(){
  $("form").initValidation();
  $(".datepicker").datepicker();
  $('#<%= row_id %>').initDialyMenu();
})</script>